class SqlAlchemyHelper(daff.SqlHelper):
    def __init__(self):
        pass

    def update(self, db, name, conds, vals):
        conds = hashify(conds)
        vals = hashify(vals)
        tab = db.getTable(name)

        # should work doesn't work :(
        #q = db.session.query(tab)
        #q = q.filter_by(**conds)
        #q = q.update(vals)

        q = db.getTable(name).update()
        for key, value in conds.items():
            q = q.where(tab.c[key] == value)
        q = q.values(vals)
        db.session.connection().execute(q)

    def delete(self, db, name, conds):
        conds = hashify(conds)
        tab = db.getTable(name)
        q = db.getTable(name).delete()
        for key, value in conds.items():
            q = q.where(tab.c[key] == value)
        db.session.connection().execute(q)

    def insert(self, db, name, vals):
        vals = hashify(vals)
        tab = db.getTable(name)
        q = db.getTable(name).insert()
        q = q.values(vals)
        db.session.connection().execute(q)

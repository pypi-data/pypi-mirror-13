

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; django-comments-xtd 1.5.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="django-comments-xtd 1.5.2 documentation" href="index.html"/>
        <link rel="next" title="Filters and Template Tags" href="templatetags.html"/>
        <link rel="prev" title="Demo projects" href="example.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> django-comments-xtd
          

          
          </a>

          
            
            
              <div class="version">
                1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="example.html">Demo projects</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workflow">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-secure-token-for-the-confirmation-url">Creating the secure token for the confirmation URL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#signal-and-receiver">Signal and receiver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sample-use-of-the-confirmation-received-signal">Sample use of the <code class="docutils literal"><span class="pre">confirmation_received</span></code> signal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#maximum-thread-level">Maximum Thread Level</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="templatetags.html">Filters and Template Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">Customizing <cite>django-comments-xtd</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">django-comments-xtd</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutorial.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<span id="ref-tutorial"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>Django-comments-xtd is a reusable app that extends the <a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/contrib/comments/">django-contrib-comments framework</a>.</p>
<div class="section" id="installation">
<span id="index-0"></span><h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Check out the code and add it to your project or <code class="docutils literal"><span class="pre">PYTHONPATH</span></code>. Use git, pip or easy_install to check out Django-comments-xtd from <a class="reference external" href="http://github.com/danirus/django-comments-xtd">Github</a> or get a release from <a class="reference external" href="http://pypi.python.org/">PyPI</a>:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Use <strong>git</strong> to clone the repository, and then install the package (read more about <a class="reference external" href="http://git-scm.com/">git</a>):</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">git://github.com/danirus/django-comments-xtd.git</span></code> and</li>
<li><code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Or use <strong>pip</strong> (read more about <a class="reference external" href="http://www.pip-installer.org/">pip</a>):</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Do <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">django-comments-xtd</span></code>, or</li>
<li>Edit your project&#8217;s <code class="docutils literal"><span class="pre">requirements</span></code> file and append either the <a class="reference external" href="http://github.com/danirus/django-comments-xtd">Github</a> URL or the package name <code class="docutils literal"><span class="pre">django-comments-xtd</span></code>, and then do <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements</span></code>.</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Or use <strong>easy_install</strong> (read more about <a class="reference external" href="http://packages.python.org/distribute/easy_install.html">easy_install</a>):</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Do <code class="docutils literal"><span class="pre">easy_install</span> <span class="pre">django-comments-xtd</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>Optionally, if you want to allow comments written in markup languages like <span class="target" id="index-1"></span>Markdown or <span class="target" id="index-2"></span>reStructuredText, install <a class="reference external" href="https://github.com/bartTC/django-markup">django-markup</a>.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="configuration">
<span id="index-3"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Configuring Django-comments-xtd comprehends the following steps:</p>
<ol class="arabic simple">
<li>Add <code class="docutils literal"><span class="pre">COMMENTS_APP</span> <span class="pre">=</span> <span class="pre">&quot;django_comments_xtd&quot;</span></code> to your settings module.</li>
<li>Add <code class="docutils literal"><span class="pre">'django.contrib.comments'</span></code> and <code class="docutils literal"><span class="pre">'django_comments_xtd'</span></code> to your <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> setting.</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>If you allow comments written in markup languages add <code class="docutils literal"><span class="pre">django_markup</span></code> to <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> too.</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Add <code class="docutils literal"><span class="pre">COMMENTS_XTD_CONFIRM_EMAIL</span> <span class="pre">=</span> <span class="pre">True</span></code> to the settings file in order to require comment confirmation by email for not logged-in users.</li>
<li>Add <code class="docutils literal"><span class="pre">url(r'^comments/',</span> <span class="pre">include('django_comments_xtd.urls'))</span></code> to your <code class="docutils literal"><span class="pre">urls.py</span></code>.</li>
<li>Create a <code class="docutils literal"><span class="pre">comments</span></code> directory in your templates directory and copy those templates from the Django Comments Framework that you want to customise. Following are the most important:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">comments/list.html</span></code> used by templatetag <code class="docutils literal"><span class="pre">render_comments_list</span></code></li>
<li><code class="docutils literal"><span class="pre">comments/form.html</span></code> used by templatetag <code class="docutils literal"><span class="pre">render_comment_form</span></code></li>
<li><code class="docutils literal"><span class="pre">comments/preview.html</span></code> used to preview the comment or when there are form errors</li>
<li><code class="docutils literal"><span class="pre">comments/posted.html</span></code> rendered after comment is sent</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>To customise how templatetag <code class="docutils literal"><span class="pre">render_last_xtdcomments</span></code> renders comments, copy the template file <code class="docutils literal"><span class="pre">django_comment_xtd/comment.html</span></code> to any of the following targets in your <code class="docutils literal"><span class="pre">templates</span></code> directory:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">django_comment_xtd/&lt;app&gt;/&lt;model&gt;/comment.html</span></code> to customise them for the given <code class="docutils literal"><span class="pre">&lt;app&gt;.&lt;model&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">django_comment_xtd/&lt;app&gt;/comment.html</span></code> to customise them for all <code class="docutils literal"><span class="pre">&lt;app&gt;</span></code> models</li>
<li><code class="docutils literal"><span class="pre">django_comment_xtd/comment.html</span></code> to customise all your site comments at once</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li>Run <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">syncdb</span></code> to create the <code class="docutils literal"><span class="pre">django_comments_xtd_xtdcomment</span></code> table.</li>
</ol>
<p>Optionally you can add extra settings to control Django-comments-xtd behaviour (see <a class="reference internal" href="settings.html"><em>Settings</em></a>). They all have sane values by default.</p>
</div>
<div class="section" id="workflow">
<span id="workflow-label"></span><span id="index-4"></span><h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>Here is the application workflow described in 4 actions:</p>
<ol class="arabic simple">
<li>The user visits a page that accepts comments. Your app or a 3rd. party app handles the request:</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>Your template shows content that accepts comments. It loads the <code class="docutils literal"><span class="pre">comments</span></code> templatetag and using tags as <code class="docutils literal"><span class="pre">render_comment_list</span></code> and <code class="docutils literal"><span class="pre">render_comment_form</span></code> the template shows the current list of comments and the <em>post your comment</em> form.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>The user <strong>clicks on preview</strong>. Django Comments Framework <code class="docutils literal"><span class="pre">post_comment</span></code> view handles the request:</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>Renders <code class="docutils literal"><span class="pre">comments/preview.html</span></code> either with the comment preview or with form errors if any.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>The user <strong>clicks on post</strong>. Django Comments Framework <code class="docutils literal"><span class="pre">post_comment</span></code> view handles the request:</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>If there were form errors it does the same as in point 2.</li>
<li>Otherwise creates an instance of <code class="docutils literal"><span class="pre">TmpXtdComment</span></code> model: an in-memory representation of the comment.</li>
<li>Send signal <code class="docutils literal"><span class="pre">comment_will_be_posted</span></code> and <code class="docutils literal"><span class="pre">comment_was_posted</span></code>. The <em>django-comments-xtd</em> receiver <code class="docutils literal"><span class="pre">on_comment_was_posted</span></code> receives the second signal with the <code class="docutils literal"><span class="pre">TmpXtdComment</span></code> instance and does as follows:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>If the user is authenticated or confirmation by email is not required (see <a class="reference internal" href="settings.html"><em>Settings</em></a>):<ul>
<li>An instance of <code class="docutils literal"><span class="pre">XtdComment</span></code> hits the database.</li>
<li>An email notification is sent to previous comments followers telling them about the new comment following up theirs. Comment followers are those who ticked the box <em>Notify me of follow up comments via email</em>.</li>
</ul>
</li>
<li>Otherwise a confirmation email is sent to the user with a link to confirm the comment. The link contains a secured token with the <code class="docutils literal"><span class="pre">TmpXtdComment</span></code>. See below <a class="reference internal" href="#the-secure-token-label"><span>Creating the secure token for the confirmation URL</span></a>.</li>
</ul>
</div></blockquote>
<ol class="loweralpha simple" start="4">
<li>Pass control to the <code class="docutils literal"><span class="pre">next</span></code> parameter handler if any, or render the <code class="docutils literal"><span class="pre">comments/posted.html</span></code> template:</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>If the instance of <code class="docutils literal"><span class="pre">XtdComment</span></code> has already been created, redirect to the the comments&#8217;s absolute URL.</li>
<li>Otherwise the template content should inform the user about the confirmation request sent by email.</li>
</ul>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>The user <strong>clicks on the confirmation link</strong>, in the email message. <em>Django-comments-xtd</em> <code class="docutils literal"><span class="pre">confirm</span></code> view handles the request:</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>Checks the secured token in the URL. If it&#8217;s wrong returns a 404 code.</li>
<li>Otherwise checks whether the comment was already confirmed, in such a case returns a 404 code.</li>
<li>Otherwise sends a <code class="docutils literal"><span class="pre">confirmation_received</span></code> signal. You can register a receiver to this signal to do some extra process before approving the comment. See <a class="reference internal" href="#signal-and-receiver-label"><span>Signal and receiver</span></a>. If any receiver returns False the comment will be rejected and the template <code class="docutils literal"><span class="pre">django_comments_xtd/discarded.html</span></code> will be rendered.</li>
<li>Otherwise an instance of <code class="docutils literal"><span class="pre">XtdComment</span></code> finally hits the database, and</li>
<li>An email notification is sent to previous comments followers telling them about the new comment following up theirs.</li>
</ol>
</div></blockquote>
<div class="section" id="creating-the-secure-token-for-the-confirmation-url">
<span id="the-secure-token-label"></span><span id="index-5"></span><h3>Creating the secure token for the confirmation URL<a class="headerlink" href="#creating-the-secure-token-for-the-confirmation-url" title="Permalink to this headline">¶</a></h3>
<p>The Confirmation URL sent by email to the user has a secured token with the comment. To create the token Django-comments-xtd uses the module <code class="docutils literal"><span class="pre">signed.py</span></code> authored by Simon Willison and provided in <a class="reference external" href="http://github.com/simonw/django-openid">Django-OpenID</a>.</p>
<p><code class="docutils literal"><span class="pre">django_openid.signed</span></code> offers two high level functions:</p>
<ul class="simple">
<li><strong>dumps</strong>: Returns URL-safe, sha1 signed base64 compressed pickle of a given object.</li>
<li><strong>loads</strong>: Reverse of dumps(), raises ValueError if signature fails.</li>
</ul>
<p>A brief example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">signed</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
<span class="go">&#39;UydoZWxsbycKcDAKLg.QLtjWHYe7udYuZeQyLlafPqAx1E&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">signed</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s">&#39;UydoZWxsbycKcDAKLg.QLtjWHYe7udYuZeQyLlafPqAx1E&#39;</span><span class="p">)</span>
<span class="go">&#39;hello&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">signed</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="s">&#39;UydoZWxsbycKcDAKLg.QLtjWHYe7udYuZeQyLlafPqAx1E-modified&#39;</span><span class="p">)</span>
<span class="go">BadSignature: Signature failed: QLtjWHYe7udYuZeQyLlafPqAx1E-modified</span>
</pre></div>
</div>
<p>There are two components in dump&#8217;s output <code class="docutils literal"><span class="pre">UydoZWxsbycKcDAKLg.QLtjWHYe7udYuZeQyLlafPqAx1E</span></code>, separatad by a &#8216;.&#8217;. The first component is a URLsafe base64 encoded pickle of the object passed to dumps(). The second component is a base64 encoded hmac/SHA1 hash of &#8220;$first_component.$secret&#8221;.</p>
<p>Calling signed.loads(s) checks the signature BEFORE unpickling the object -this protects against malformed pickle attacks. If the signature fails, a ValueError subclass is raised (actually a BadSignature).</p>
</div>
</div>
<div class="section" id="signal-and-receiver">
<span id="signal-and-receiver-label"></span><span id="index-6"></span><h2>Signal and receiver<a class="headerlink" href="#signal-and-receiver" title="Permalink to this headline">¶</a></h2>
<p>In addition to the <a class="reference external" href="https://docs.djangoproject.com/en/1.3/ref/contrib/comments/signals/">signals sent by the Django Comments Framework</a>, django-comments-xtd sends the following signal:</p>
<blockquote>
<div><ul class="simple">
<li><strong>confirmation_received</strong>: Sent when the user clicks on the confirmation link and before the <code class="docutils literal"><span class="pre">XtdComment</span></code> instance is created in the database.</li>
<li><strong>comment_thread_muted</strong>: Sent when the user clicks on the mute link, in a follow-up notification.</li>
</ul>
</div></blockquote>
<div class="section" id="sample-use-of-the-confirmation-received-signal">
<h3>Sample use of the <code class="docutils literal"><span class="pre">confirmation_received</span></code> signal<a class="headerlink" href="#sample-use-of-the-confirmation-received-signal" title="Permalink to this headline">¶</a></h3>
<p>You might want to register a receiver for <code class="docutils literal"><span class="pre">confirmation_received</span></code>. An example function receiver could check the time stamp in which a user submitted a comment and the time stamp in which the confirmation URL has been clicked. If the difference between them is over 7 days we will discard the message with a graceful <cite>&#8220;sorry, it&#8217;s a too old comment&#8221;</cite> template.</p>
<p>Extending the demo site with the following code will do the job:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#----------------------------------------</span>
<span class="c"># append the code below to demo/views.py:</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">django_comments_xtd</span> <span class="kn">import</span> <span class="n">signals</span>

<span class="k">def</span> <span class="nf">check_submit_date_is_within_last_7days</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">plus7days</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;submit_date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">plus7days</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">False</span>
<span class="n">signals</span><span class="o">.</span><span class="n">confirmation_received</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">check_submit_date_is_within_last_7days</span><span class="p">)</span>


<span class="c">#-----------------------------------------------------</span>
<span class="c"># change get_comment_create_data in django_comments_xtd/forms.py to cheat a</span>
<span class="c"># bit and make Django believe that the comment was submitted 7 days ago:</span>

<span class="k">def</span> <span class="nf">get_comment_create_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>                                     <span class="c"># ADD THIS</span>

    <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CommentForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_comment_create_data</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;followup&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s">&#39;followup&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">COMMENTS_XTD_CONFIRM_EMAIL</span><span class="p">:</span>
        <span class="c"># comment must be verified before getting approved</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;is_public&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;submit_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c"># ADD THIS</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Try the demo site again and see that the <cite>django_comments_xtd/discarded.html</cite> template is rendered after clicking on the confirmation URL.</p>
</div>
</div>
<div class="section" id="maximum-thread-level">
<span id="index-7"></span><h2>Maximum Thread Level<a class="headerlink" href="#maximum-thread-level" title="Permalink to this headline">¶</a></h2>
<p>Nested comments are disabled by default, to enable them use the following settings:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">COMMENTS_XTD_MAX_THREAD_LEVEL</span></code>: an integer value</li>
<li><code class="docutils literal"><span class="pre">COMMENTS_XTD_MAX_THREAD_LEVEL_BY_APP_MODEL</span></code>: a dictionary</li>
</ul>
</div></blockquote>
<p>Django-comments-xtd inherits the flexibility of <a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/contrib/comments/">django-contrib-comments framework</a>, so that developers can plug it to support comments on as many models as they want in their projects. It is as suitable for one model based project, like comments posted to stories in a simple blog, as for a project with multiple applications and models.</p>
<p>The configuration of the maximum thread level on a simple project is done by declaring the <code class="docutils literal"><span class="pre">COMMENTS_XTD_MAX_THREAD_LEVEL</span></code> in the <code class="docutils literal"><span class="pre">settings.py</span></code> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">COMMENTS_XTD_MAX_THREAD_LEVEL</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Comments then could be nested up to level 2:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;In an instance detail page that allows comments&gt;

First comment (level 0)
  |-- Comment to First comment (level 1)
    |-- Comment to Comment to First comment (level 2)
</pre></div>
</div>
<p>Comments posted to instances of every model in the project will allow up to level 2 of threading.</p>
<p>On a project that allows users posting comments to instances of different models, the developer may want to declare a maximum thread level per <code class="docutils literal"><span class="pre">app.model</span></code> basis. For example, on an imaginary blog project with stories, quotes, diary entries and book/movie reviews, the developer might want to define a default project wide maximum thread level of 1 for any model and an specific maximum level of 5 for stories and quotes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">COMMENTS_XTD_MAX_THREAD_LEVEL</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">COMMENTS_XTD_MAX_THREAD_LEVEL_BY_APP_MODEL</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;blog.story&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">&#39;blog.quote&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So that <code class="docutils literal"><span class="pre">blog.review</span></code> and <code class="docutils literal"><span class="pre">blog.diaryentry</span></code> instances would support comments nested up to level 1, while <code class="docutils literal"><span class="pre">blog.story</span></code> and <code class="docutils literal"><span class="pre">blog.quote</span></code> instances would allow comments nested up to level 5.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="templatetags.html" class="btn btn-neutral float-right" title="Filters and Template Tags" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example.html" class="btn btn-neutral" title="Demo projects" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Daniel Rus Morales.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
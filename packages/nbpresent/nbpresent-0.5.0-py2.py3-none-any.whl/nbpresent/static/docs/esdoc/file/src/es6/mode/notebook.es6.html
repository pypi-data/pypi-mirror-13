<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/es6/mode/notebook.es6 | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="git://github.com/Anaconda-Server/nbpresent.git">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/editor.es6~Editor.html">Editor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/mini.es6~MiniSlide.html">MiniSlide</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/regiontree.es6~RegionTree.html">RegionTree</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/sorter.es6~Sorter.html">Sorter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/templates.es6~TemplateLibrary.html">TemplateLibrary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/toolbar.es6~Toolbar.html">Toolbar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/tour.es6~NbpresentTour.html">NbpresentTour</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/tree.es6~Tree.html">Tree</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-bbox">bbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PART">PART</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PART_SELECT">PART_SELECT</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/cells</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/cells/notebook.es6~CellManager.html">CellManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/cells/standalone.es6~CellManager.html">CellManager</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/layout</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/layout/manual.es6~ManualLayout.html">ManualLayout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/layout/treemap.es6~TreemapLayout.html">TreemapLayout</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/mode</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/mode/base.es6~Mode.html">Mode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/mode/notebook.es6~Mode.html">Mode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/mode/standalone.es6~Mode.html">Mode</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/presenter</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/presenter/base.es6~Presenter.html">Presenter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/presenter/notebook.es6~NotebookPresenter.html">NotebookPresenter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/presenter/standalone.es6~StandalonePresenter.html">StandalonePresenter</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/speaker</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/speaker/base.es6~SpeakerBase.html">SpeakerBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/speaker/notebook.es6~NotebookSpeaker.html">NotebookSpeaker</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">es6/style</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/style/base.es6~BaseStyle.html">BaseStyle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/es6/style/slab.es6~SlabStyle.html">SlabStyle</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/es6/mode/notebook.es6</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import Jupyter from &quot;base/js/namespace&quot;;
import {CellToolbar} from &quot;notebook/js/celltoolbar&quot;;

import {d3, $} from &quot;nbpresent-deps&quot;;

import {NotebookPresenter} from &quot;../presenter/notebook&quot;;
import {Sorter} from &quot;../sorter&quot;;
import {PART} from &quot;../parts&quot;;
import {NbpresentTour} from &quot;../tour&quot;;
import {Tree} from &quot;../tree&quot;;

import {Mode as BaseMode} from &quot;./base&quot;;

export class Mode extends BaseMode {
  init() {
    this.initStylesheet();

    let tree = new Tree({
      slides: this.metadata().slides,
      root: this.root
    });

    this.tree = tree.tree;

    this.slides = this.tree.select([&quot;slides&quot;]);
    this.slides.on(&quot;update&quot;, () =&gt; this.metadata(true))

    this.tour = new NbpresentTour(this);
    this.tour.init();

    this.presenter = new NotebookPresenter(this.tree, this.tour);
    this.sorter = new Sorter(this.tree, this.tour);

    this.initToolbar();
  }

  initStylesheet(){
    let css = d3.select(&quot;head&quot;)
      .selectAll(&quot;link#nbpresent-css&quot;)
      .data([1]);

    if(css.node()){
      console.warn(&quot;nbpresent extension already loaded!&quot;);
      return;
    }

    css.enter()
      .append(&quot;link&quot;)
      .attr({id: &quot;nbpresent-css&quot;})
      .attr({
        rel: &quot;stylesheet&quot;,
        href: `${this.root}/nbpresent.min.css`
      });
  }

  metadata(update){
    let md = Jupyter.notebook.metadata;
    if(update){
      md.nbpresent = {
        slides: this.slides.serialize()
      };
    }else{
      return md.nbpresent || {
        slides: {}
      }
    }
  }

  show(){
    this.sorter.show();
    this.tour.start();
    $(&apos;#header-container&apos;).toggle();
    $(&apos;.header-bar&apos;).toggle();
  }

  present(){
    this.presenter.presenting.set(true);
  }

  unpresent(){
    this.presenter.presenting.set(false);
  }

  initToolbar() {
    $(&quot;#view_menu&quot;).append($(&quot;&lt;li/&gt;&quot;).append($(&quot;&lt;a/&gt;&quot;)
      .text(&quot;Toggle Present&quot;)
      .on(&quot;click&quot;, ()=&gt;{
        this.show();
      })));

    // TODO: make this one button!
    Jupyter.toolbar.add_buttons_group([
      {
        label: &quot;Slide Sorter&quot;,
        icon: &quot;fa-th-large&quot;,
        callback: () =&gt; this.show(),
        id: &quot;nbpresent_sorter_btn&quot;
      },
      {
        label: &quot;Present&quot;,
        icon: &quot;fa-youtube-play&quot;,
        callback: () =&gt; this.present(),
        id: &quot;nbpresent_present_btn&quot;
      }
    ]);
    let that = this;

    var nbpresent_preset = [];

    let add_to_region = (div, cell) =&gt; {
      let $div = d3.select(div[0]);

      $div.append(&quot;i&quot;).attr(&quot;class&quot;, &quot;fa fa-link&quot;);

      $div.append(&quot;span&quot;).text(&quot; Region &quot;);

      let $btn = $div.selectAll(&quot;.btn&quot;)
        .data([PART.source, PART.outputs, PART.widgets])
        .enter()
        .append(&quot;button&quot;)
        .classed({btn: 1, &quot;btn-default&quot;: 1, &quot;btn-xs&quot;: 1})
        .text((d) =&gt; d)
        .on(&quot;click&quot;, (d) =&gt; that.sorter.linkContent(d));
    };

    CellToolbar.register_callback(&quot;nbpresent.add_to_region&quot;, add_to_region);
    nbpresent_preset.push(&quot;nbpresent.add_to_region&quot;);

    CellToolbar.register_preset(&quot;nbpresent&quot;, nbpresent_preset, Jupyter.notebook);

    // update the download chrome
    let dlMenu = d3.select(d3.select(&quot;#download_html&quot;).node().parentNode);

    dlMenu.insert(&quot;li&quot;, &quot;:nth-child(4)&quot;)
      .append(&quot;a&quot;)
      .classed({download_nbpresent_html: 1})
      .text(&quot;Presentation (.html)&quot;)
      .on(&quot;click&quot;, () =&gt; this.nbconvert(&quot;nbpresent&quot;));

    dlMenu.insert(&quot;li&quot;, &quot;:nth-child(5)&quot;)
      .append(&quot;a&quot;)
      .classed({download_nbpresent_pdf: 1})
      .text(&quot;Presentation (.pdf)&quot;)
      .on(&quot;click&quot;, () =&gt; this.nbconvert(&quot;nbpresent_pdf&quot;));

  }

  nbconvert(key){
    Jupyter.menubar._nbconvert(key, true);
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.3)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>

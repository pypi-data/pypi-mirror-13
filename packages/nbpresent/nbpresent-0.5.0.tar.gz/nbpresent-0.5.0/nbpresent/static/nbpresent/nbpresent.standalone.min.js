(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.nbpresentStandalone = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellManager=void 0;var _nbpresentDeps=require("nbpresent-deps"),_parts=require("../parts");window.html2canvas=_nbpresentDeps.html2canvas;var _thumbs={},CellManager=exports.CellManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getCells",value:function(){var e={};return _nbpresentDeps.d3.selectAll(".cell").each(function(){var t=_nbpresentDeps.d3.select(this),n=t.attr("data-nbpresent-id");n&&(e[n]={element:[t.node()]})}),e}},{key:"getPart",value:function(e){var t=this.getCells()[e.cell];if(!t)return null;var n=_nbpresentDeps.d3.select(t.element[0]),r=n.select(_parts.PART_SELECT[e.part]);return r}},{key:"thumbnail",value:function(e){var t=e.cell+"-"+e.part;if(!_thumbs[t]){var n=this.getPart(e);if(n=n?n.node():null,!n)return Promise.reject(e);_thumbs[t]=(0,_nbpresentDeps.html2canvas)(n).then(function(e){return{canvas:e,uri:e.toDataURL("image/png"),width:e.width,height:e.height}},function(e){console.log(e)})}return _thumbs[t]}}]),e}();

},{"../parts":6,"nbpresent-deps":"nbpresent-deps"}],2:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.ManualLayout=void 0;var _nbpresentDeps=require("nbpresent-deps"),KEY="manual",ManualLayout=exports.ManualLayout=function(){function e(t,n,a){_classCallCheck(this,e),this.tree=t,this.slide=n,this.container=a}return _createClass(e,[{key:"key",value:function(){return KEY}},{key:"init",value:function(){var e=this.container,t=e.clientWidth,n=e.clientHeight;this.x=_nbpresentDeps.d3.scale.linear().range([0,t]),this.y=_nbpresentDeps.d3.scale.linear().range([0,n])}},{key:"update",value:function(e,t){var n=e.value.attrs,a=n.x,i=n.y,l=n.width,r=n.height,s=n.z;s=s||0,t.style({height:this.y(r)+"px",left:this.x(a)+"px",top:this.y(i)+"px",width:this.x(l)+"px"})}},{key:"clean",value:function(e){e.style({left:null,top:null,width:null,height:null})}}],[{key:"clsKey",value:function(){return KEY}}]),e}();

},{"nbpresent-deps":"nbpresent-deps"}],3:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreemapLayout=void 0;var _nbpresentDeps=require("nbpresent-deps"),_manual=require("./manual"),KEY="treemap",TreemapLayout=exports.TreemapLayout=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"key",value:function(){return KEY}},{key:"init",value:function(){_get(Object.getPrototypeOf(t.prototype),"init",this).call(this);var e=this;this.treemap=_nbpresentDeps.d3.layout.treemap().size([100,100]).sticky(!0).value(function(e){return e._value.attrs["treemap:weight"]||1});var r=_nbpresentDeps.d3.entries(this.slide.value.regions).map(function(e){return e._value=e.value,e});r.filter(function(e){return null==e.value.attrs["treemap:weight"]}).map(function(t){e.tree.merge(["slides",e.slide.key,"regions",t.key,"attrs"],{"treemap:weight":t.value["treemap:weight"]||1})}),this.treemap({children:r}),r.map(function(t){var r=["slides",e.slide.key,"regions",t.key,"attrs"],n=e.tree.get(r),o={x:t.x/100,y:t.y/100,width:t.dx/100,height:t.dy/100},i=void 0;for(var a in o)n[a]!==o[a]&&((i?i:i={})[a]=o[a]);i&&e.tree.merge(r,i)})}}],[{key:"clsKey",value:function(){return KEY}}]),t}(_manual.ManualLayout);

},{"./manual":2,"nbpresent-deps":"nbpresent-deps"}],4:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mode=void 0;var _nbpresentDeps=require("nbpresent-deps"),Mode=exports.Mode=function e(s){_classCallCheck(this,e),this.root=s,this.init()};

},{"nbpresent-deps":"nbpresent-deps"}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mode=void 0;var _nbpresentDeps=require("nbpresent-deps"),_tree=require("../tree"),_standalone=require("../presenter/standalone"),_base=require("./base"),Mode=exports.Mode=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){var e=JSON.parse(_nbpresentDeps.d3.select("#nbpresent_tree").text()),t=new _tree.Tree({slides:e.slides,root:this.root});this.tree=t.tree,this.presenter=new _standalone.StandalonePresenter(this.tree),this.presenter.presenting.set(!0)}}]),t}(_base.Mode);

},{"../presenter/standalone":8,"../tree":13,"./base":4,"nbpresent-deps":"nbpresent-deps"}],6:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var PART={source:"source",outputs:"outputs",widgets:"widgets"},PART_SELECT={source:".inner_cell",outputs:".output_wrapper",widgets:".widget-area .widget-subarea"};exports.PART=PART,exports.PART_SELECT=PART_SELECT;

},{}],7:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Presenter=void 0;var _nbpresentDeps=require("nbpresent-deps"),_base=require("../speaker/base"),_manual=require("../layout/manual"),_treemap=require("../layout/treemap"),_parts=require("../parts"),_slab=require("../style/slab"),PREFIX=["-webkit-","-moz-","-ms-","-o-",""],Presenter=exports.Presenter=function(){function e(t){var n=this;_classCallCheck(this,e),this.tree=t,this.cellManager=this.makeCellManager(),this.speaker=this.makeSpeaker(this.tree),this.initUI(),this.presenting=this.tree.select(["presenting"]),this.current=this.tree.select(["selectedSlide"]),this.tree.on("update",function(){return n.update()}),this.presenting.on("update",function(){return n.present()}),this.current.on("update",function(){return n.update()})}return _createClass(e,[{key:"makeCellManager",value:function(){throw new Error("Not implemented")}},{key:"makeSpeaker",value:function(e){return new _base.SpeakerBase(e)}},{key:"initUI",value:function(){this.$ui=_nbpresentDeps.d3.select("body").append("div").classed({nbpresent_presenter:1}).style({display:"none"})}},{key:"layoutClass",value:function(e){return{manual:_manual.ManualLayout,treemap:_treemap.TreemapLayout}[e.value.layout||"manual"]}},{key:"updateLayout",value:function(e){var t=this.layoutClass(e);this.layout&&this.layout.key()==t.clsKey()&&this.layout.slide.key===e.key?this.layout.slide=e:this.layout=new t(this.tree,e,document.documentElement),this.layout.init()}},{key:"present",value:function(){this.update()}},{key:"getCells",value:function(){return this.cellManager.getCells()}},{key:"update",value:function(){var e=this,t=this.presenting.get();_nbpresentDeps.d3.select("body").classed({nbpresent_presenting:t}),this.$ui.style({display:t?"block":"none"}).style({opacity:+t});var n=this.current.get(),r=this.tree.get(["sortedSlides",function(e){return e.key==n}]);if(!r)return this.current.set(this.tree.get(["sortedSlides",0,"key"]));if(this.updateLayout(r),!t)return this.clean(!0);var s=this.getCells();_nbpresentDeps.d3.selectAll(this.allPartSelect()).classed({nbpresent_unpresent:1,nbpresent_present:0}),_nbpresentDeps.d3.entries(r.value.regions).filter(function(e){var t=e.value;return t.content}).map(function(t){var n=t.value.content,r=s[n.cell];if(r){var a=_nbpresentDeps.d3.select(r.element[0]),l=a.select(_parts.PART_SELECT[n.part]);l.classed({nbpresent_unpresent:0,nbpresent_present:1}).each(function(){return e.layout.update(t,l)}),_nbpresentDeps.d3.entries(t.value.style).map(function(e){if(e.value&&"slab"===e.key){var t=new _slab.SlabStyle;t.update(l)}})}}),this.clean()}},{key:"allPartSelect",value:function(){return _nbpresentDeps.d3.entries(_parts.PART_SELECT).map(function(e){var t=e.value;return".cell "+t}).join(", ")}},{key:"clean",value:function(e){var t=this;e&&_nbpresentDeps.d3.selectAll(this.allPartSelect()).classed({nbpresent_unpresent:1,nbpresent_present:0}),_nbpresentDeps.d3.selectAll(".nbpresent_unpresent").call(t.layout&&this.layout.clean||function(){return 0}).classed({nbpresent_unpresent:0,nbpresent_present:0})}}]),e}();

},{"../layout/manual":2,"../layout/treemap":3,"../parts":6,"../speaker/base":9,"../style/slab":11,"nbpresent-deps":"nbpresent-deps"}],8:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.StandalonePresenter=void 0;var _standalone=require("../cells/standalone"),_base=require("./base"),StandalonePresenter=exports.StandalonePresenter=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"makeCellManager",value:function(){return new _standalone.CellManager}}]),t}(_base.Presenter);

},{"../cells/standalone":1,"./base":7}],9:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpeakerBase=void 0;var _nbpresentDeps=require("nbpresent-deps"),_toolbar=require("../toolbar"),SpeakerBase=exports.SpeakerBase=function(){function e(t){var n=this;_classCallCheck(this,e),this.tree=t,this.current=this.tree.select(["selectedSlide"]),this.presenting=this.tree.select(["presenting"]),this.initUI(),this.presenting.on("update",function(){return n.update()}),this.update()}return _createClass(e,[{key:"initUI",value:function(){this.$ui=_nbpresentDeps.d3.select("body").append("div").classed({nbpresent_speaker:1}),this.initToolbar()}},{key:"update",value:function(){this.$ui.style({display:this.presenting.get()?null:"none"})}},{key:"toolbarIcons",value:function(){var e=this,t=this;return[[{icon:"fast-backward",click:function(){return t.current.set(e.tree.get(["sortedSlides",0,"key"]))},tip:"Back to Start"}],[{icon:"step-backward",click:function(){var n=t.tree.get(["slides",e.current.get()]);e.current.set(n.prev)},tip:"Previous Slide"}],[{icon:"step-forward",click:function(){return e.advance()},tip:"Next Slide"}]]}},{key:"advance",value:function(){var e=this,t=this.tree.get(["slides"]),n=t[this.current.get()];return _nbpresentDeps.d3.entries(t).map(function(t){t.value.prev===n.id&&e.current.set(t.key)}),this.current.get()}},{key:"initToolbar",value:function(){var e=new _toolbar.Toolbar;e.btnGroupClass("btn-group-vertical").btnClass("btn-link btn-lg").tipOptions({container:"body",placement:"top"}),this.$toolbar=this.$ui.append("div").classed({presenter_toolbar:1}).datum(this.toolbarIcons()).call(e.update)}}]),e}();

},{"../toolbar":12,"nbpresent-deps":"nbpresent-deps"}],10:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var BaseStyle=exports.BaseStyle=function e(){_classCallCheck(this,e)};

},{}],11:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.SlabStyle=void 0;var _nbpresentDeps=require("nbpresent-deps"),_base=require("./base"),SlabStyle=exports.SlabStyle=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"update",value:function(e){this.slab=new _nbpresentDeps.VanillaSlab;var t="data-nbpresent-slab-id";if(!e.attr(t)){var r=_nbpresentDeps.uuid.v4();e.attr(t,r),this.slab.init({selector:'[data-nbpresent-slab-id="'+r+'"] h1'})}}}]),t}(_base.BaseStyle);

},{"./base":10,"nbpresent-deps":"nbpresent-deps"}],12:[function(require,module,exports){
"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toolbar=void 0;var _nbpresentDeps=require("nbpresent-deps"),fn=_nbpresentDeps.d3.functor,Toolbar=function(){function t(){_classCallCheck(this,t),this._btnClass=fn("btn-default"),this._btnGroupClass=fn("btn-group"),this._tipOptions=fn({container:"body"}),this.update=this.update.bind(this)}return _createClass(t,[{key:"btnClass",value:function(t){return arguments.length?[this._btnClass=fn(t),this][1]:this._btnClass}},{key:"tipOptions",value:function(t){return arguments.length?[this._tipOptions=fn(t),this][1]:this._tipOptions}},{key:"btnGroupClass",value:function(t){return arguments.length?[this._btnGroupClass=fn(t),this][1]:this._btnGroupClass}},{key:"update",value:function(t){var n=this,e=this;t.classed({"btn-toolbar":1,nbpresent_toolbar:1});var r=t.selectAll(".btn-toolbar-group").data(function(t){return t});r.enter().append("div").classed({"btn-toolbar-group":1}).classed(this._btnGroupClass(),1);var s=r.selectAll(".btn").data(function(t){return t},function(t){return t.tip});s.enter().append("a").attr("class",function(t){return"btn "+n._btnClass(t)}).attr({title:function(t){return t.tip}}).each(function(t){$.fn.tooltip&&$(this).tooltip(e._tipOptions(t))}).append("i"),s.on("click",function(t){return t.click()}).select("i").attr({"class":function(t){return"fa fa-fw fa-2x fa-"+t.icon}});var i=function(){$(this).tooltip("destroy")};s.filter(function(t){return t.visible&&!t.visible()}).each(i).remove(),s.exit().each(i).remove(),r.exit().remove()}}]),t}();exports.Toolbar=Toolbar;

},{"nbpresent-deps":"nbpresent-deps"}],13:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tree=void 0;var _nbpresentDeps=require("nbpresent-deps"),Tree=exports.Tree=function(){function e(r){_classCallCheck(this,e),this.tree=new _nbpresentDeps.Baobab(_nbpresentDeps.$.extend({slides:{},presenter:{presenting:!1},sorter:{},editor:{},sortedSlides:_nbpresentDeps.Baobab.monkey(["slides"],this.sortedSlides)},r))}return _createClass(e,[{key:"sortedSlides",value:function(e){var r=_nbpresentDeps.d3.entries(e);return r.sort(function(e,r){return null===e.value.prev||e.key===r.value.prev?-1:1}),r}}]),e}();

},{"nbpresent-deps":"nbpresent-deps"}]},{},[5])(5)
});
{% extends 'admin/master.html' %}
{% import 'shelf/lib.html' as lib with context %}
{% import 'admin/static.html' as admin_static with context %}
{% import 'shelf/model/layout.html' as model_layout with context %}

{% macro edit_extra_btn() %}
    <li class="actions">
        <a role="submit" class="_continue_editing" href="javascript:void(0)">
            <i class="fa fa-refresh"></i> {{ _gettext('Save and Continue') }}
        </a>
    </li>
    {{ lib.get_view_extensions("extra_btn") }}
{% endmacro %}

{% macro edit_extra_fld() %}
{% endmacro %}

{% block head %}
    {{ super() }}
    <link href="{{ admin_static.url(filename='select2/select2.css') }}" rel="stylesheet">
    <link href="{{ url_for('shelf.static', filename='select2/select2-flat.css') }}" rel="stylesheet">
    <link href="{{ url_for('shelf.static', filename='switchery/switchery.min.css') }}" rel="stylesheet">
    <link href="{{ admin_static.url(filename='datetimepicker/bootstrap-datetimepicker.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
    <div class="row create col-xs-12">
        <div class="title">
            {% block model_create_title %}
                <h1>{{ admin_view.name.upper() }}</h1>
            {% endblock %}
        </div>
        <div class="content">
          {% call lib.form_tag(form) %}
              {{ lib.render_form_fields(form, form_opts=form_opts, extra=edit_extra_fld()) }}
          {% endcall %}
        </div>
    </div>
    {#<div class="col-lg-2 hidden-xs hidden-sm hidden-md" style="margin-top: 49px; margin-left: 15px">
        <ul class="list-group">
            {% if form_opts and form_opts.form_rules %}
                {% for r in form_opts.form_rules %}
                    {{ r(form, form_opts=form_opts) }}
                {% endfor %}
            {% else %}
                {% for f in form if f.type != 'HiddenField' and f.type != 'CSRFTokenField' %}
                  <li class="list-group-item" style="padding-top: 5px; padding-bottom: 5px">
                    <a href="#{{f.id }}">{{ f.label }}</a>
                  </li>
                {% endfor %}
            {% endif %}
        </ul>
    </div>#}
{% endblock %}

<<<<<<< HEAD
{% block bottom %}
    <div class="navbar navbar-default navbar-fixed-bottom">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                {% block bartitle %}<a class="navbar-brand" href="#">{{ admin_view.name }}</a>{% endblock %}
            </div>
            <div class="collapse navbar-collapse">
                {% block model_menu_bar %}
                <ul class="nav navbar-nav">
                  {% if actions %}
                  <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">Actions  <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            {% for p in actions %}
                            <li class="actions delete disabled">
                                <a href="javascript:void(0)" onclick="return modelActions.execute('{{ p[0] }}');">{% if p[2] %}<i class="fa fa-{{p[2]}}"></i>  {% endif %}{{ _gettext(p[1]) }}</a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>
                    {% endif %}

                  {% if admin_view.get_preview_url(model) %}
                  <li class="actions"><a href="{{ admin_view.get_preview_url(model) }}" target="new"><i class="fa fa-eye"></i>  {{ _gettext('Preview') }}</a></li>
                  {% endif %}

                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li class="actions"><a href="{{ return_url }}"><i class="fa fa-times"></i> {{ _gettext('Cancel') }}</a></li>
                  {% if has_workflow %}
                      {% if model.shelf_state == "draft" %}
                      <li class="actions draft dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)"><span><i class="fa fa-file-text-o"></i> {{ _gettext('Draft') }}</span> <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="actions draft" style="display:none"><a href="javascript:void(0)"><i class="fa fa-file-text-o"></i> {{ _gettext('Draft') }}</a></li>
                                <li class="actions review"><a href="javascript:void(0)"><i class="fa fa-search"></i> {{ _gettext('Review') }}</a></li>
                                <li class="actions publish"><a href="javascript:void(0)"><i class="fa fa-thumbs-up"></i> {{ _gettext('Published') }}</a></li>
                            </ul>
                        </li>
                        {% elif model.shelf_state == "private" %}
                        <li class="actions review dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)"><span><i class="fa fa-search"></i> {{ _gettext('Review') }}</span> <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="actions draft"><a href="javascript:void(0)"><i class="fa fa-file-text-o"></i> {{ _gettext('Draft') }}</a></li>
                                <li class="actions review" style="display:none"><a href="javascript:void(0)"><i class="fa fa-search"></i> {{ _gettext('Review') }}</a></li>
                                <li class="actions publish"><a href="javascript:void(0)"><i class="fa fa-thumbs-up"></i> {{ _gettext('Published') }}</a></li>
                            </ul>
                        </li>
                        {% elif model.shelf_state == "public" %}
                        <li class="actions publish dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)"><span><i class="fa fa-thumbs-up"></i> {{ _gettext('Published') }}</span> <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li class="actions draft"><a href="javascript:void(0)"><i class="fa fa-file-text-o"></i> {{ _gettext('Draft') }}</a></li>
                                <li class="actions review"><a href="javascript:void(0)"><i class="fa fa-search"></i> {{ _gettext('Review') }}</a></li>
                                <li class="actions publish" style="display:none"><a href="javascript:void(0)"><i class="fa fa-thumbs-up"></i> {{ _gettext('Published') }}</a></li>
                            </ul>
                        </li>
                        {% endif %}
                    {% endif %}
                  <li class="actions"><a role="submit" class="update-model" href="#"><i class="fa fa-refresh"></i>  {{ _gettext('Update') }}</a></li>
                  <li class="actions"><a role="submit" class="save-model" href="#"><i class="fa fa-check"></i>  {{ _gettext('Save') }}</a></li>
                </ul>
                {% endblock %}
            </div>
        </div>
    </div>
{% endblock %}

{% block tail %}
  {{ super() }}
  <script src="{{ url_for('admin.static', filename='datetimepicker/bootstrap-datetimepicker.js') }}"></script>

  <script src="{{ url_for('shelf.static', filename='shelf/js/wysihtml5-0.3.0.min.js') }}"></script>
  <script src="{{ url_for('shelf.static', filename='shelf/js/bootstrap3-wysihtml5.all.min.js') }}"></script>
  <script src="{{ url_for('shelf.static', filename='shelf/js/bootstrap3-wysihtml5.min.js') }}"></script>
  <script src={{ url_for('shelf.static', filename='tinymce/tinymce.min.js') }}></script>
  <script href="{{ url_for('shelf.static', filename='shelf-select2/select2.js') }}" ></script>
    <script src="{{ url_for('shelf.static', filename='shelf/js/form.js') }}"></script>
=======
{% block page_body %}
    {{ super() }}
    {% call lib.navbar(admin_view.name, pos="bottom") %}
        {{ lib.render_form_buttons(return_url, edit_extra_btn()) }}
    {% endcall %}
{% endblock %}

{% block tail_js %}
    {{ super() }}
    <script src="{{ admin_static.url(filename='datetimepicker/bootstrap-datetimepicker.js') }}"></script>
    <script src="{{ url_for('shelf.static', filename='switchery/switchery.min.js') }}"></script>
    <script src="{{ shelf_static.url(filename='shelf/js/form.js') }}"></script>
>>>>>>> new
    <script language="javascript">
        (function($) {
            $('a.save-model').click(function (e) {
                $("form.model-form").submit();
                e.stopPropagation();
            });

            $('a._continue_editing').click(function (e) {
                $("form.model-form").append(
                    "<input type='hidden' name='_continue_editing' value='1'></input>"
                );
                $("form.model-form").submit();
                e.stopPropagation();
            });

            var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));

            elems.forEach(function(html) {
              var switchery = new Switchery(html, { color: '#a9a3d9', secondaryColor: '#e0e0e0' });
            });
<<<<<<< HEAD

            $('.wysiwyg').wysihtml5({
                html: true,
            });

         tinymce.init({
             selector: ".wysiwyg-full",
             plugins: "autoresize,paste,image,link,code,searchreplace,table,media",
         });
=======
>>>>>>> new
        })(jQuery);
    </script>
{% endblock %}
